

# 组件渲染过程
- props state
- render() 生成 vnode
- patch(elem, vnode)

# 组件更新的过程
- setState(newState) --> dirtyComponents（可能有子组件）
- render() 生成 newVnode
- patch(vnode, newVnode)

# 更新的两个阶段
patch 被拆分为两个阶段：
- **reconciliation 阶段**：执行 diff 算法，纯 JS 计算
- **commit 阶段**：将 diff 结果渲染 DOM

可能会有性能问题：
- JS 是单线程的，且和 DOM 渲染共用一个线程
- 当组件足够复杂，组件更新时计算和渲染都压力大，如果再有 DOM 操作需求（动画，鼠标拖拽等）会卡顿

解决方案 fiber：
- 将 reconciliation 阶段 进行任务拆分（commit 无法拆分）
- DOM 需要渲染时（通过 window.requestIdleCallback）暂停，空闲时恢复任务



