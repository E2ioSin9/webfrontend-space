目录

[TOC]

## Route组件

Route组件，可以设置一些属性：
- path：匹配哈希后面的值
匹配规则：页面的哈希值必须完全包含完整path的值（不多也不少），`非严格匹配`。Route`不设置path`是匹配所有URL地址。
例如：
path='/' ：和它匹配的地址只有要斜杠即可（都能和它匹配）
path='/user'：“#/user/login”也可以匹配，但是“#/user2”这个无法匹配


- `exact`：path匹配严格（只有URL的hash值和path设定的值相等才可以匹配到）
strict也是严格匹配，不常用
- component：哈希值和当前Route的path相同，则渲染component指定的组件
- render：当页面的hash地址和path匹配，会把render规划的方法执行。
		一般在render中`处理权限校验`。（在组件渲染之前，没有权限不渲染这个组件）。
- push：如果设置了这个属性，当前跳转的地址会加入到history stack中一条记录
- from：设置当前来源页面地址
```javascript
import {HashRouter, Route, Switch, Redirect} from 'react-router-dom';
//=>A B C 三个组件
ReactDOM.render(<HashRouter>
    <Switch>//如果可以匹配多个，Switch只匹配第一个
        <Route path='/' exact component={A}/>
        <Route path='/user' component={B}/>
        <Route path='/pay' component={C} render={() => {
            let flag = localStorage.getItem('FLAG');
            if (flag && flag === 'safe') {
                return <C/>;
            }
            return '当前环境不安全，不利于支付！';
        }}/>
    </Switch>
</HashRouter>, root);
```
默认情况下，会和每一个Route都做校验（哪怕之前已经有校验成功的）。Switch组件可以解决这个问题，只要有一种情况校验成功，就不再往后校验了。


以上都不符合的情况下，认为路由地址是非法地址，做一些特殊处理
- 处理为404
- 也可以重定向：
        to=[string]： 重新定向到新的地址
        to=[object]：
          {
            pathName: 定向的地址,
            search: 给定向的地址问号传参,（真实项目，会根据是否存在问号参数值来判断是正常进入首页还是非正常跳转过来的，也有根据问号传参值做不同的事情）
            state: 给定向后的组件传递一些信息
          } 
```javascript
    <Switch>
        {/*处理404*/}
        <Route render={() => {
            return <div>404</div>
        }}/>
        {/*也可以重定向：to重新定向到新的地址*/}
        <Redirect to='/'/>
        <Redirect to={{
            pathname: '/',
            search: '?lx=404'
        }}/>
        <Redirect from='/360buy' to='/jd'/>
    </Switch>
```

## Link 和 NavLink 组件

1. Link组件是react-router中提供的路由切换组件，基于它可以实现`点击时切换路由`。
react-router中提供的组件都要在`任何一个Router（常用HashRouter）包裹的范围内`使用。
- to[string] ：跳转到指定的路由地址
- to[object] ：可以提供一些参数配置项
{
pathname：跳转地址
serach：问号传参
state：基于这种方式传递信息值
}
- replace[boolean]：默认为false，是替换history stack中当前的地址（true），还是追加一个新的地址（false）

原理：基于Link组件渲染，渲染后的结果就是a标签，to对应的信息最后会变为href中的内容
```javascript
<Link
  to={{
    pathname: '/',
    search: '?lx=logo'
  }}>
  我的CRM
</Link>
<a class="navbar-brand" href="#/?lx=logo">my CRM</a>
```

2. NavLink和Link类似，都是为了实现路由切换跳转的。
=>
不同的在于：NavLink组件在`当前页面URL的HASH地址和组件to对应地址相匹配`时，会默认给组件加一个active样式类，让其有选中态。并不是点击谁就有active类名。
和Link类似，to和replace属性都有，用法一样
- activeClassName：把默认加的active样式类改为自己的
- activeStyle：给匹配的这个NavLink设置行内样式
- exact & strict：控制是否是严格匹配
- isActive：匹配后执行对应的函数
```javascript
<NavLink to='/custom'>//最后也会转换为a标签，如果当前页面的hash地址和此组件中的to地址匹配了，则会给渲染后的A标签设置默认的样式类：active
```
所有经过路由管控的组件，当URL的hash和path后面的地址匹配后，组件才会重新渲染。不经路由管控的组件，点击NavLink，不会重新渲染组件。

## withRouter 组件
作用：把一个非路由管控的组件，模拟成为路由管控的组件。
先把Nav基于connect高阶一下，返回的是一个代理组件Proxy，把返回的代理组件受路由管控即可。
```javascript
import { withRouter } from 'react-router-dom';
export default withRouter(connect()(Nav));
```
## useHistory
```js
import { useHistory } from 'react-router-dom';

const history = useHistory();
onClick = () => {
  history.push('/')
}
```



# 面试高频题目