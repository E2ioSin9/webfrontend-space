
创建分支，就是创建不同的线路来管理历史版本。

# 分支模型

## commit object
Git 保存的不是文件的变化或者差异，而是一系列不同时刻的文件快照。

在进行提交操作时，Git 会先计算每一个子目录的校验和，保存为一个`提交对象（commit object）`。该提交对象包含了作者的姓名和邮箱、提交时输入的信息以及指向它的父对象（树对象）的指针。

Git 仓库中有五个对象：一个提交对象（包含着指向前述树对象的指针和所有提交信息）、一个树对象（记录着目录结构和 blob 对象索引）以及三个 blob 对象（保存着文件快照）。

![commit](https://user-images.githubusercontent.com/22387652/71957146-ee384580-3227-11ea-94be-e59d8aa2e156.png)


# 基础操作
## 创建分支，切换到分支上

- `$ git branch`: 查看本地存在的分支
- `$ git branch -a`: 查看所有分支（包括本地和远程）

分支前面的 *代表当前在哪个分支上

- 创建并且切换到新建的分支
不管是 新 feature，还是 bugfix，一般都是基于 master 创建新的分支，基于哪个分支创建，就会把这个分支的信息  copy 到新建的分支上 
`$ git branch [branch-name]`
切换到dev分支上
`$ git checkout [branch-name]`
创建并切换，也可以一步完成--delete
`$ git checkout -b [branch-name]`


## 删除分支

- 删除本地分支：`git branch -d [branch-name]`
- 删除远程分支: `$ git push origin --delete [branch-name]`, 远程分支的名称有remotes/origin/，比如 remotes/origin/feature/1.0，删的时候只写 feature/1.0

注意：删除的时候需要先切换到其它分支才可以删除当前分支


## push 新建的分支

当我们新建一个分支，还远程仓库没有这个分支时，执行`$ git push`会报下面这个错误：

fatal: The current branch [branch-name] has no upstream branch.
To push the current branch and set the remote as upstream

说明当前分支在中央 github 没有上游分支，执行：
`$ git push --set-upstream origin [branch-name]`



## 切换到某一分支

当 执行`$ git checkout [branch-name]`报下面这个错误时，

error: pathspec [branch-name] did not match any file(s) known to git.

`$ git remote update`

`$ git fetch`

## 本地、远程分支重命名

1. 先将本地分支重命名
`$ git branch -m oldBranch [newBranch]`

2. 删除远程分支（远端无此分支则跳过该步骤）
`$ git push --delete origin [oldBranch]`

3. 将重命名后的分支推到远端
`$ git push origin [newBranch]`

4. 把修改后的本地分支与远程分支关联
`$ git branch --set-upstream-to origin/[newBranch]`


## 合并特定Commits 到另一个分支

1. 单个Commit
有时候会有这样一种场景，当前分支会用到 别的分支的 单个commit，怎么合并过来呢？

首先切换到对应的分支，git log 拿到想要的 commit-id，再切回当前分支，使用 cherry-pick：
`$ git cherry-pick [commit-id]`

2.  一系列相连的commits
在一些特性情况下，合并单个commit并不够，你需要合并一系列相连的commits。这种情况下就不要选择cherry-pick了，rebase 更适合。还以上例为例，假设你需要合并feature分支的Commit 76aaa ~62bbb 到 master分支。
首先需要基于feature创建一个新的分支，并指明新分支的最后一个commit：

git checkout -b newbranch 62bbb  
然后，rebase这个新分支的commit到master（--ontomaster）。76caaa^ 指明你想从哪个特定的commit开始。

git rebase --ontomaster 76caaa^  
得到的结果就是feature分支的commit 76caaa ~62bbb 都被合并到了master分支。

